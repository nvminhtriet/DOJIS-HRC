!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pmrpc=e():t.pmrpc=e()}(self,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=73)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={INVOKE:"invoke",RPC_RESOLVE:"rpc-resolve",RPC_REJECT:"rpc-reject",API_DESCRIPTION:"api-desc",INVOKE_FUNCTION:"invoke-func",RESOLVE:"resolve",REJECT:"reject",REQUEST_API:"request-api"}},function(t,e,r){var n=r(41);t.exports=function(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}},function(t,e,r){var n=r(19);t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},function(t,e,r){var n=r(10)(Object,"create");t.exports=n},function(t,e,r){var n=r(13),o=r(67),i=r(66),u="[object Null]",a="[object Undefined]",c=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?a:u:c&&c in Object(t)?o(t):i(t)}},function(t,e,r){var n=r(71);t.exports=function(t,e,r){var o=null==t?void 0:n(t,e);return void 0===o?r:o}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=e.serialize=void 0;var n=i(r(5)),o=i(r(25));function i(t){return t&&t.__esModule?t:{default:t}}e.serialize=function(t){return Promise.reject((0,o.default)(t)?{type:(e=t).constructor.name,message:e.message,stack:e.stack}:t);var e},e.deserialize=function(t){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type;return"Error"===t||(0,o.default)((0,n.default)(self,[t,"prototype"]))}(t)?function(t){var e=t.type,r=t.stack,n=t.message,o=new(self[e]||Error)(n);return o.stack=r,o}(t):t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sendResponse=e.send=void 0;var n=r(17);function o(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}e.send=function(t,e){var r=e.target,i=e.targetOrigin,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return new Promise(function(e){var a=new MessageChannel,c=a.port1,s=a.port2;t.__port=s,(0,n.isWorker)()||r instanceof Worker||r instanceof MessagePort?r.postMessage(t,[s].concat(o(u))):r.postMessage(t,i,[s].concat(o(u))),c.onmessage=function(t){var r=t.data;return e(r)}})},e.sendResponse=function(t,e){return function(r){return t.postMessage({intent:e,result:r})}}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,r){var n=r(4),o=r(8),i="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";t.exports=function(t){if(!o(t))return!1;var e=n(t);return e==u||e==a||e==i||e==c}},function(t,e,r){var n=r(58),o=r(54);t.exports=function(t,e){var r=o(t,e);return n(r)?r:void 0}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,r){var n=r(69),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},function(t,e,r){var n=r(12).Symbol;t.exports=n},function(t,e,r){var n=r(4),o=r(11),i="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||o(t)&&n(t)==i}},function(t,e){var r=Array.isArray;t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(0),i=(n=o)&&n.__esModule?n:{default:n},u=r(6);e.default=function(t){var e=t.intent,r=t.result;switch(e){case i.default.RESOLVE:return r;case i.default.REJECT:return Promise.reject((0,u.deserialize)(r));default:return Promise.reject()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.isWorker=function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope},e.getChildFrameById=function(t){return document.getElementById(t)}},function(t,e,r){var n=r(14),o=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,r){var n=r(15),o=r(70),i=r(65),u=r(37);t.exports=function(t,e){return n(t)?t:o(t,e)?[t]:i(u(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=!1;e.addSingleHandler=function(t){n||(n=!0,self.addEventListener("message",t))},e.removeSingleHandler=function(t){self.removeEventListener("message",t),n=!1}},function(t,e){t.exports=function(t,e){return function(r){return t(e(r))}}},function(t,e,r){var n=r(22)(Object.getPrototypeOf,Object);t.exports=n},function(t,e,r){var n=r(4),o=r(23),i=r(11),u="[object Object]",a=Function.prototype,c=Object.prototype,s=a.toString,f=c.hasOwnProperty,p=s.call(Object);t.exports=function(t){if(!i(t)||n(t)!=u)return!1;var e=o(t);if(null===e)return!0;var r=f.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&s.call(r)==p}},function(t,e,r){var n=r(4),o=r(11),i=r(24),u="[object DOMException]",a="[object Error]";t.exports=function(t){if(!o(t))return!1;var e=n(t);return e==a||e==u||"string"==typeof t.message&&"string"==typeof t.name&&!i(t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=e.serialize=void 0;var n=a(r(9)),o=r(7),i=a(r(0)),u=a(r(16));function a(t){return t&&t.__esModule?t:{default:t}}e.serialize=function(t){return t.reduce(function(t,e){var r=t.args,u=t.transfer;if((0,n.default)(e)){var a=new MessageChannel,c=a.port1,s=a.port2;c.onmessage=function(t){var r=t.data,n=r.__port;Promise.resolve(e.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(r))).then((0,o.sendResponse)(n,i.default.RESOLVE),(0,o.sendResponse)(n,i.default.REJECT))};var f=u.length;r.push({type:"function",index:f,port:s}),u.push(s)}else r.push({type:"value",value:e});return{args:r,transfer:u}},{args:[],transfer:[]})},e.deserialize=function(t){return t.map(function(t){return"value"===t.type?t.value:function(){for(var e=t.port,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(0,o.send)(n,{target:e}).then(u.default)}})}},function(t,e){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var o=typeof t;return!!(e=null==e?r:e)&&("number"==o||"symbol"!=o&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,r){var n=r(10),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e,r){var n=r(28);t.exports=function(t,e,r){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},function(t,e,r){var n=r(29),o=r(19),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){var u=t[e];i.call(t,e)&&o(u,r)&&(void 0!==r||e in t)||n(t,e,r)}},function(t,e,r){var n=r(30),o=r(20),i=r(27),u=r(8),a=r(18);t.exports=function(t,e,r,c){if(!u(t))return t;for(var s=-1,f=(e=o(e,t)).length,p=f-1,l=t;null!=l&&++s<f;){var v=a(e[s]),d=r;if(s!=p){var y=l[v];void 0===(d=c?c(y,v,l):void 0)&&(d=u(y)?y:i(e[s+1])?[]:{})}n(l,v,d),l=l[v]}return t}},function(t,e,r){var n=r(31);t.exports=function(t,e,r){return null==t?t:n(t,e,r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.invokeApiFunction=e.getDescription=e.buildApiFromDescription=void 0;var n=p(r(0)),o=r(7),i=p(r(5)),u=p(r(32)),a=p(r(9)),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(26)),s=r(6),f=p(r(16));function p(t){return t&&t.__esModule?t:{default:t}}function l(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var v=!0;e.buildApiFromDescription=function(t,e,r){return Object.keys(e).sort().reduce(function(e,i){return(0,u.default)(e,i,function(t,e,r){return function(){for(var i=arguments.length,u=Array(i),a=0;a<i;a++)u[a]=arguments[a];var s=c.serialize(u),p=s.args,l=s.transfer;return(0,o.send)({appId:t,call:r,args:p,intent:n.default.INVOKE_FUNCTION},e,l).then(f.default)}}(t,r,i))},{})};function d(t,e){return(0,a.default)(t)?(r={},n=e.join("."),o=v,n in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r):{};var r,n,o}var y=function t(e,r){var n=function(t,e){return 0===e.length?t:(0,i.default)(t,e)}(r,e),o=Object.keys(n).reduce(function(n,o){return Object.assign(n,t([].concat(l(e),[o]),r))},{});return Object.assign(d(n,e),o)};e.getDescription=function(t){return y([],t)},e.invokeApiFunction=function(t,e){try{var r=c.deserialize(e);return Promise.resolve(t.apply(void 0,l(r))).catch(s.serialize)}catch(t){return(0,s.serialize)(t)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEmpty=e.unregisterApp=e.hasApp=e.getAppData=e.getAppById=e.registerApp=void 0;var n,o=r(5),i=(n=o)&&n.__esModule?n:{default:n};var u={};e.registerApp=function(t,e,r){u[t]={app:e,onApiCall:r}},e.getAppById=function(t){return(0,i.default)(u,[t,"app"])},e.getAppData=function(t){return u[t]},e.hasApp=function(t){return Boolean(u[t])},e.unregisterApp=function(t){return delete u[t]},e.isEmpty=function(){return Object.keys(u).length>0}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}},function(t,e,r){var n=r(13),o=r(35),i=r(15),u=r(14),a=1/0,c=n?n.prototype:void 0,s=c?c.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(u(e))return s?s.call(e):"";var r=e+"";return"0"==r&&1/e==-a?"-0":r}},function(t,e,r){var n=r(36);t.exports=function(t){return null==t?"":n(t)}},function(t,e,r){var n=r(1);t.exports=function(t,e){var r=n(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}},function(t,e,r){var n=r(1);t.exports=function(t){return n(this,t).has(t)}},function(t,e,r){var n=r(1);t.exports=function(t){return n(this,t).get(t)}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,r){var n=r(1);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e,r){var n=r(10)(r(12),"Map");t.exports=n},function(t,e,r){var n=r(2);t.exports=function(t,e){var r=this.__data__,o=n(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}},function(t,e,r){var n=r(2);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,r){var n=r(2);t.exports=function(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}},function(t,e,r){var n=r(2),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=n(e,t);return!(r<0||(r==e.length-1?e.pop():o.call(e,r,1),--this.size,0))}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,r){var n=r(48),o=r(47),i=r(46),u=r(45),a=r(44);function c(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=u,c.prototype.set=a,t.exports=c},function(t,e,r){var n=r(3),o="__lodash_hash_undefined__";t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?o:e,this}},function(t,e,r){var n=r(3),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}},function(t,e,r){var n=r(3),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var r=e[t];return r===o?void 0:r}return i.call(e,t)?e[t]:void 0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,r){var n=r(12)["__core-js_shared__"];t.exports=n},function(t,e,r){var n,o=r(56),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!i&&i in t}},function(t,e,r){var n=r(9),o=r(57),i=r(8),u=r(55),a=/^\[object .+?Constructor\]$/,c=Function.prototype,s=Object.prototype,f=c.toString,p=s.hasOwnProperty,l=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(n(t)?l:a).test(u(t))}},function(t,e,r){var n=r(3);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e,r){var n=r(59),o=r(53),i=r(52),u=r(51),a=r(50);function c(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=u,c.prototype.set=a,t.exports=c},function(t,e,r){var n=r(60),o=r(49),i=r(43);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},function(t,e,r){var n=r(61),o=r(42),i=r(40),u=r(39),a=r(38);function c(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=u,c.prototype.set=a,t.exports=c},function(t,e,r){var n=r(62),o="Expected a function";function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(i.Cache||n),r}i.Cache=n,t.exports=i},function(t,e,r){var n=r(63),o=500;t.exports=function(t){var e=n(t,function(t){return r.size===o&&r.clear(),t}),r=e.cache;return e}},function(t,e,r){var n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,i=r(64)(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,function(t,r,n,i){e.push(n?i.replace(o,"$1"):r||t)}),e});t.exports=i},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,r){var n=r(13),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,a=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,a),r=t[a];try{t[a]=void 0;var n=!0}catch(t){}var o=u.call(t);return n&&(e?t[a]=r:delete t[a]),o}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(this,r(68))},function(t,e,r){var n=r(15),o=r(14),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!o(t))||u.test(t)||!i.test(t)||null!=e&&t in Object(e)}},function(t,e,r){var n=r(20),o=r(18);t.exports=function(t,e){for(var r=0,i=(e=n(e,t)).length;null!=t&&r<i;)t=t[o(e[r++])];return r&&r==i?t:void 0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unset=e.request=e.set=void 0;var n=l(r(5)),o=p(r(34)),i=r(17),u=l(r(0)),a=r(33),c=r(7),s=p(r(21)),f=r(6);function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function l(t){return t&&t.__esModule?t:{default:t}}var v=function(t){var e=t.data,r=e.appId,i=e.intent,s=e.call,p=e.args,l=e.__port;switch(i){case u.default.REQUEST_API:var v=o.getAppById(r),d=v?(0,a.getDescription)(v):null;return l.postMessage(d),Promise.resolve();case u.default.INVOKE_FUNCTION:var y=o.getAppData(r);if(!y){var h=new Error("The API for "+r+" has been removed");return(0,c.sendResponse)(l,u.default.REJECT)((0,f.serialize)(h))}y.onApiCall&&y.onApiCall({appId:r,call:s,args:p});var _=(0,n.default)(y.app,s);return(0,a.invokeApiFunction)(_,p).then((0,c.sendResponse)(l,u.default.RESOLVE),(0,c.sendResponse)(l,u.default.REJECT))}return Promise.resolve()};e.set=function(t,e){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).onApiCall;o.hasApp(t)&&o.unregisterApp(t),o.registerApp(t,e,r),s.addSingleHandler(v)},e.request=function(t){var e=function(t){var e=t.target,r=t.initiator;switch(!0){case(0,i.isWorker)():return{target:self,targetOrigin:"*"};case"undefined"!=typeof parent&&e===parent:return{target:parent,targetOrigin:"*"};case e instanceof Worker:return{target:e};case Boolean(e):return e.contentWindow?{target:e.contentWindow,targetOrigin:e.src}:{target:e,targetOrigin:"*"};case Boolean(r):var n=(0,i.getChildFrameById)(r);return{target:n.contentWindow,targetOrigin:n.src};default:throw new Error("Invalid target")}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return(0,c.send)({intent:u.default.REQUEST_API,appId:t},e).then(function(r){return r?(0,a.buildApiFromDescription)(t,r,e):Promise.reject(new Error("App with ID "+t+" not found"))})},e.unset=function(t){o.unregisterApp(t),o.isEmpty()&&s.removeSingleHandler(v)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.api=void 0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(72));e.api=n}])});
//# sourceMappingURL=pm-rpc.min.js.map